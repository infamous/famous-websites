(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";function initialize(e,r){var a=e.name,i=e.fragments,n=i[0];if(!n)return null;var t,s,l=i.length;for(t=0;l>t;t++){s=i[t];var p=s.element;if(p.style.display="none",t>0){var o=s.wrapper,E=o.wrapperElement;o.parentNode&&E.parentNode.removeChild(E)}}var d=n.nodeValue,g=Parser.parseObject(d,r.optionKey),u=n.wrapper,m=Parser.parseString(d,r.widthKey)||DEFAULT_WIDTH,T=Parser.parseString(d,r.heightKey)||DEFAULT_HEIGHT;u.prepare(m,T);for(var c=[];l--;){s=i[l];var A=s.nodeValue,f=Parser.parseObject(A,r.optionKey);Utilities.merge(g,f);var I=Parser.parseString(A,r.languageKey),_=Parser.parseString(A,r.filenameKey);_&&!I&&(I=Helper.assignLanguageFromFilename(_)),I||(I=r.defaultLanguage),_||(_=Helper.assignFilename(a,I,r)),_.indexOf(".")<0&&(_=Helper.assignFilenameExtension(_,I,r));var F=Helper.cleanupContent(s.nodeValue,r);c.push({path:_,language:I,content:F})}var L=document.createElement("iframe");L.className=r.containerClassName,L.style.cssText=IFRAME_INITIAL_STYLE;var v=r.endpoint;return r.identifier&&(v+="?identifier="+r.identifier),L.src=v,L.setAttribute("allowfullscreen",""),IFRAME_READY_STYLE+="width:"+m+";",IFRAME_READY_STYLE+="height:"+T+";",L.onload=function(){L.contentWindow.postMessage({options:g,files:c},r.containerTargetOrigin),L.style.cssText=IFRAME_READY_STYLE},u.wrapperElement.appendChild(L),L}var Helper=require("./helper"),Parser=require("./parser"),Utilities=require("./utilities"),IFRAME_INITIAL_STYLE="display:none;",IFRAME_READY_STYLE="border:none;padding:0;margin:0;",DEFAULT_WIDTH="100%",DEFAULT_HEIGHT="480px";module.exports={initialize:initialize}},{"./helper":6,"./parser":8,"./utilities":9}],2:[function(require,module,exports){module.exports={context:"body",selector:'pre > code, script[type="text/template"]',prefix:"@famous-block",filenameKey:"@famous-block-filename",languageKey:"@famous-block-language",groupKey:"@famous-block-group",widthKey:"@famous-block-width",heightKey:"@famous-block-height",optionKey:"@famous-block-option",defaultLanguage:"javascript",wrapperClassName:"famous-block-container-wrapper",containerClassName:"famous-block-container",containerTargetOrigin:"*",untitledGroupNamePrefix:"group-",untitledFilenamePrefix:"untitled",languageExtensionMapping:{javascript:".js",js:".js",html:".html",xhtml:".html",htm:".html",css:".css","default":".js"}}},{}],3:[function(require,module,exports){"use strict";function inViewport(e){var n=e.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&n.right<=(window.innerWidth||document.documentElement.clientWidth)}function nodeValue(e){var n,t,o="",i=e.childNodes,d=i.length;for(n=0;d>n;n++)t=i[n],o+=8===t.nodeType?COM_PRE+t.nodeValue+COM_SUF:t.nodeValue;return o}var COM_PRE="<!--",COM_SUF="-->";module.exports={inViewport:inViewport,nodeValue:nodeValue}},{}],4:[function(require,module,exports){"use strict";function Fragment(e,t){if(this.tagName=e.tagName.toLowerCase(),"code"===this.tagName){var r=e.parentNode;this.element="pre"===r.tagName.toLowerCase()?r:e}else this.element=e;this.wrapper=new Wrapper(this.element,t),this.innerHTML=e.innerHTML,this.nodeValue=Elem.nodeValue(e)}var Wrapper=require("./wrapper"),Elem=require("./element");module.exports=Fragment},{"./element":3,"./wrapper":10}],5:[function(require,module,exports){"use strict";function generateGroupName(e){return e+numGroupNamesGenerated++}function collate(e,r){var t,n,a,u,o,p=[],s=r.groupKey,l=new RegExp(s+"\\s+\\S+","ig"),m={},i=e.length;for(o=0;i>o;o++)t=e[o],n=t.nodeValue,u=n.match(l),u&&u[0]&&(u=u[0].split(/\s+/)[1]),a=u?u:generateGroupName(r.untitledGroupNamePrefix),m[a]||(m[a]=[]),m[a].push(t);for(a in m)m.hasOwnProperty(a)&&p.push({name:a,fragments:m[a]});return p}var numGroupNamesGenerated=0;module.exports={collate:collate}},{}],6:[function(require,module,exports){"use strict";function assignFilename(n,e,t){var i=t.languageExtensionMapping[e];filenames[n]||(filenames[n]={}),void 0===filenames[n][i]&&(filenames[n][i]=0);var s=t.untitledFilenamePrefix,a=filenames[n][i]++;return 0===a?s+i:s+"-"+a+i}function assignFilenameExtension(n,e,t){e||(e="default");var i=t.languageExtensionMapping[e];return n+i}function assignLanguageFromFilename(n){return JS_RE.test(n)?"javascript":CSS_RE.test(n)?"css":HTML_RE.test(n)?"html":JSON_RE.test(n)?"json":MD_RE.test(n)?"markdown":null}function stripDirectives(n,e){var t,i,s=[],a=n.split("\n"),r=new RegExp(e.prefix,"ig");for(t=0,i=a.length;i>t;t++){var l=a[t],o=!1;l.match(r)&&(o=!0),o||s.push(l)}return s.join("\n")}function removeIndentation(n){var e=n.split("\n");if(e.length<1)return"";for(var t=0,i=e.length;i>t;t++){var s=e[t];null==s&&(e[t]="")}for(;null!=e[0]&&e[0].length<1;)e.shift();for(;e.length>0&&e[e.length-1]<1;)e.pop();if(e.length<1)return"";for(var a=e[0].length,r=0,l=e.length;l>r;r++){var o=e[r],g=o.match(/^\s+/);if(g){var u=g[0],m=u.length;a>m&&(a=m)}else a=0}for(var p=[],f=0,c=e.length;c>f;f++){var v=e[f];v.length>a?p.push(v.slice(a,v.length)):0===v.length&&p.push(v)}return p.join("\n")}function fixScriptEscapes(n){return n.split("<\\/script>").join("</script>")}function cleanupContent(n,e){var t=stripDirectives(n,e),i=removeIndentation(t,e),s=fixScriptEscapes(i,e);return s}var filenames={},JS_RE=/\.js$/i,CSS_RE=/\.css$/i,HTML_RE=/\.html$/i,JSON_RE=/\.json$/i,MD_RE=/\.md$/i;module.exports={cleanupContent:cleanupContent,removeIndentation:removeIndentation,stripDirectives:stripDirectives,assignFilename:assignFilename,assignFilenameExtension:assignFilenameExtension,assignLanguageFromFilename:assignLanguageFromFilename}},{}],7:[function(require,module,exports){"use strict";function initialize(){var i=document.querySelector(config.context),t=i.querySelectorAll(config.selector),e=Utilities.map(t,function(i){return new Fragment(i,config)}),n=Utilities.select(e,function(i){return i.innerHTML.indexOf(config.prefix)>-1}),r=Group.collate(n,config);Utilities.each(r,function(i){Container.initialize(i,config)})}var Utilities=require("./utilities"),Fragment=require("./fragment"),Group=require("./group"),Container=require("./container"),defaults=require("./defaults"),config=Utilities.extend(defaults,{}),scriptEls=document.getElementsByTagName("script"),thisScriptEl=scriptEls[scriptEls.length-1],scriptPath=thisScriptEl.src,scriptFolder=scriptPath.substr(0,scriptPath.lastIndexOf("/")+1),containerPath=scriptFolder+"../container/index.html";config.endpoint||(config.endpoint=containerPath),window.onload=initialize,module.exports={}},{"./container":1,"./defaults":2,"./fragment":4,"./group":5,"./utilities":9}],8:[function(require,module,exports){"use strict";var TRUE_STR="true",FALSE_STR="false",SCRIPT_INCLUDE_OPTION="includeScript",STYLESHEET_INCLUDE_OPTION="includeStylesheet",PARTS_SPLITTER=/\s+/;module.exports={parseObject:function(T,e){var t={},S=new RegExp(e+"\\s*.*","ig"),r=T.match(S);if(!r)return t;var E,s,n,R,_,i=r.length;for(E=0;i>E;E++)s=r[E],n=s.split(PARTS_SPLITTER),n.shift(),n&&n[0]&&(R=n[0],_=n[1],_===TRUE_STR&&(_=!0),_===FALSE_STR&&(_=!1),R===SCRIPT_INCLUDE_OPTION||R===STYLESHEET_INCLUDE_OPTION?(t[R]||(t[R]=[]),t[R].push(_)):t[R]=_);return t},parseString:function(T,e){var t=new RegExp(e+"\\s*.*","ig"),S=T.match(t);return S&&S[0]?S[0].split(/\s+/)[1]:null}}},{}],9:[function(require,module,exports){"use strict";function merge(e,r){var n;for(n in r)r.hasOwnProperty(n)&&null!=r[n]&&(e[n]=r[n]);return e}function extend(e,r){var n={};return n=merge({},e),n=merge(n,r)}function select(e,r){var n,t,u,a=[];for(n=0,t=e.length;t>n;n++)u=e[n],r(u,n,e)&&a.push(u);return a}function map(e,r){var n,t,u=[];for(n=0,t=e.length;t>n;n++)u.push(r(e[n],n,e));return u}function each(e,r){var n,t;for(n=0,t=e.length;t>n;n++)r(e[n],n,e)}module.exports={extend:extend,merge:merge,map:map,each:each,select:select}},{}],10:[function(require,module,exports){"use strict";function Wrapper(e,t){this.originalElement=e,this.wrapperElement=window.document.createElement("div"),this.wrapperElement.className=t.wrapperClassName,this.wrapperElement.style.cssText=INITIAL_STYLE}var INITIAL_STYLE="width:0;height:0;padding:0;margin:0;visiblity:hidden;",PREPARE_STYLE="visibility:visible;background-color:transparent;",DEFAULT_WIDTH="auto",DEFAULT_HEIGHT="480px";Wrapper.prototype.prepare=function(e,t){var r=e||DEFAULT_WIDTH,i=t||DEFAULT_HEIGHT;PREPARE_STYLE+="width:"+r+";",PREPARE_STYLE+="height:"+i+";",this.wrapperElement.style.cssText=PREPARE_STYLE,this.originalElement.parentNode.insertBefore(this.wrapperElement,this.originalElement)},module.exports=Wrapper},{}]},{},[7]);